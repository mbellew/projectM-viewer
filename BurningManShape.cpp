//
// Created by matthew on 4/23/18.
//

#include "pmSDL.hpp"
#include "BurningManShape.h"

static svg_op bmOrig[] = {
    M(82.46,703.835),
    c(-11.455,-5.389,-16.368,-19.048,-10.979,-30.502),
    //l(0,0),
    c(0,-0.011,1.329,-2.82,3.786,-8.281),
    //l(0,0),
    c(2.445,-5.473,5.981,-13.485,10.218,-23.513),
    //l(0,0),
    c(8.475,-20.083,19.808,-48.279,31.109,-80.505),
    //l(0,0),
    c(22.667,-64.311,44.863,-145.374,44.706,-207.181),
    //l(0,0),
    c(0,-6.6,-0.235,-12.96,-0.736,-19.037),
    //l(0,0),
    c(-3.998,-51.687,-33.68,-116.585,-66.664,-171.523),
    //l(0,0),
    C(61.048,108.202,25.479,62.461,11.535,45.17),
    //l(0,0),
    c(-3.99,-4.95,-6.102,-7.442,-6.113,-7.454),
    //l(0,0),
    c(-8.178,-9.661,-6.967,-24.128,2.706,-32.295),
    //l(0,0),
    c(9.672,-8.178,24.128,-6.967,32.306,2.705),
    //l(0,0),
    c(0.414,0.501,38.336,45.339,77.964,107.565),
    //l(0,0),
    c(39.486,62.473,81.403,141.388,87.849,215.373),
    //l(0,0),
    c(0.604,7.465,0.89,15.075,0.89,22.789),
    //l(0,0),
    c(-0.154,71.918,-23.963,155.472,-47.283,222.351),
    //l(0,0),
    c(-23.404,66.723,-46.679,116.182,-46.892,116.652),
    //l(0,0),
    c(-3.906,8.304,-12.148,13.166,-20.751,13.166),
    //l(0,0),
    C(88.939,706.022,85.616,705.317,82.46,703.835),
    //L(82.46,703.835),
    Z(),

    M(342.478,692.851),
    c(-0.201,-0.47,-23.49,-49.919,-46.892,-116.652),
    //l(0,0),
    c(-23.334,-66.879,-47.143,-150.433,-47.3,-222.339),
    //l(0,0),
    c(0,-7.75,0.297,-15.357,0.906,-22.799),
    //l(0,0),
    c(6.452,-73.988,48.375,-152.887,87.857,-215.362),
    //l(0,0),
    C(376.689,53.472,414.6,8.634,415.014,8.122),
    //l(0,0),
    l(0.011,0.011),
    c(8.17,-9.672,22.624,-10.881,32.299,-2.717),
    //l(0,0),
    c(9.657,8.178,10.878,22.634,2.702,32.307),
    //l(0,0),
    c(0,0.011,-2.126,2.504,-6.11,7.453),
    //l(0,0),
    c(-3.989,4.936,-9.747,12.201,-16.687,21.339),
    //l(0,0),
    c(-13.888,18.278,-32.577,44.066,-51.508,73.798),
    //l(0,0),
    c(-38.017,59.257,-76.341,135.358,-80.84,194.51),
    //l(0,0),
    c(-0.498,6.099,-0.755,12.461,-0.755,19.036),
    //l(0,0),
    c(-0.106,54.023,16.804,122.966,36.293,182.32),
    //l(0,0),
    c(19.428,59.459,41.167,109.735,49.762,128.867),
    //l(0,0),
    c(2.445,5.473,3.771,8.281,3.788,8.293),
    //l(0,0),
    c(5.389,11.454,0.471,25.102,-10.989,30.502),
    //l(0,0),
    c(-3.156,1.482,-6.469,2.188,-9.736,2.188),
    //l(0,0),
    C(354.637,706.028,346.383,701.154,342.478,692.851),
    //L(342.478,692.851),
    Z(),

    M(207.821,203.555),
    L(146.225,95.76),
    c(-5.324,-9.322,-3.494,-21.02,4.415,-28.266),
    //l(0,0),
    l(61.597,-56.466),
    c(8.769,-8.049,22.201,-8.049,30.969,0),
    //l(0,0),
    l(61.597,56.466),
    c(7.907,7.235,9.736,18.944,4.415,28.266),
    //l(0,0),
    L(247.62,203.555),
    c(-4.062,7.104,-11.711,11.541,-19.897,11.541),
    //l(0,0),
    C(219.542,215.096,211.884,210.658,207.821,203.555),
    //L(207.821,203.555),
    Z(),
    M(195.111,88.914),
    l(32.606,57.07),
    l(32.617,-57.081),
    l(-32.611,-29.895),
    //L(195.111,88.914),
    Z()
};

static svg_op *bm = NULL;


BurningManShape::BurningManShape()
{
    if (NULL == bm)
    {
        bm = (svg_op *)malloc(sizeof(bmOrig));
        memcpy(bm, bmOrig, sizeof(bmOrig));
        // scale to -1..1
        for (int i=0 ; i<sizeof(bmOrig)/sizeof(svg_op) ; i++)
        {
            svg_op *op = bm+i;
            for (int p=0 ; p<6 ; p+=2)
            {
                switch (op->type)
                {
                case 'M':
                case 'Z':
                case 'L':
                case 'C':
                    op->data[p+0] = (op->data[p+0] - 227.717) / 800.0;
                    op->data[p+1] = (op->data[p+1] - 350.0) / 800.0;
                    break;
                case 'l':
                case 'c':
                    op->data[p+0] = op->data[p+0] / 800.0;
                    op->data[p+1] = op->data[p+1] / 800.0;
                    break;
                }
            }
        }
    }
    radius = 1.0;
    border_r=border_g=border_b=0;
    r=g=b=0;
}
int BurningManShape::svg_length()
{
    return sizeof(bmOrig)/sizeof(svg_op);
}
struct svg_op *BurningManShape::svg_data()
{
    return bm;
}
void BurningManShape::release(struct svg_op *)
{
}
